<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Boundary · TrixiParticles.jl</title><meta name="title" content="Boundary · TrixiParticles.jl"/><meta property="og:title" content="Boundary · TrixiParticles.jl"/><meta property="twitter:title" content="Boundary · TrixiParticles.jl"/><meta name="description" content="Documentation for TrixiParticles.jl."/><meta property="og:description" content="Documentation for TrixiParticles.jl."/><meta property="twitter:description" content="Documentation for TrixiParticles.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TrixiParticles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../news/">News</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><span class="tocitem">Components</span><ul><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">General</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../general/semidiscretization/">Semidiscretization</a></li><li><a class="tocitem" href="../../general/initial_condition/">Initial Condition and Setups</a></li><li><a class="tocitem" href="../../general/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../general/density_calculators/">Density Calculators</a></li><li><a class="tocitem" href="../../general/smoothing_kernels/">Smoothing Kernels</a></li><li><a class="tocitem" href="../../general/neighborhood_search/">Neighborhood Search</a></li><li><a class="tocitem" href="../../general/util/">Util</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox" checked/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../weakly_compressible_sph/">Weakly Compressible SPH (Fluid)</a></li><li><a class="tocitem" href="../entropically_damped_sph/">Entropically Damped Artificial Compressibility for SPH (Fluid)</a></li><li><a class="tocitem" href="../total_lagrangian_sph/">Total Lagrangian SPH (Elastic Structure)</a></li><li class="is-active"><a class="tocitem" href>Boundary</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#boundary_models"><span>Boundary Models</span></a></li><li><a class="tocitem" href="#Dummy-Particles"><span>Dummy Particles</span></a></li><li><a class="tocitem" href="#Repulsive-Particles"><span>Repulsive Particles</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../time_integration/">Time Integration</a></li><li><a class="tocitem" href="../../callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../reference-trixibase/">TrixiBase.jl API Reference</a></li></ul></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Components</a></li><li><a class="is-disabled">Systems</a></li><li class="is-active"><a href>Boundary</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Boundary</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/main/docs/src/systems/boundary.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Boundary-System"><a class="docs-heading-anchor" href="#Boundary-System">Boundary System</a><a id="Boundary-System-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-System" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.BoundarySPHSystem" href="#TrixiParticles.BoundarySPHSystem"><code>TrixiParticles.BoundarySPHSystem</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BoundarySPHSystem(initial_condition, boundary_model; movement=nothing)</code></pre><p>System for boundaries modeled by boundary particles. The interaction between fluid and boundary particles is specified by the boundary model.</p><p><strong>Arguments</strong></p><ul><li><code>initial_condition</code>: Initial condition (see <a href="../../general/initial_condition/#TrixiParticles.InitialCondition"><code>InitialCondition</code></a>)</li><li><code>boundary_model</code>: Boundary model (see <a href="#boundary_models">Boundary Models</a>)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>movement</code>: For moving boundaries, a <a href="#TrixiParticles.BoundaryMovement"><code>BoundaryMovement</code></a> can be passed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/1575d76846627c667cfc322d1e15c10a96ead960/src/schemes/boundary/system.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.BoundaryMovement" href="#TrixiParticles.BoundaryMovement"><code>TrixiParticles.BoundaryMovement</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BoundaryMovement(movement_function, is_moving; moving_particles=nothing)</code></pre><p><strong>Arguments</strong></p><ul><li><code>movement_function</code>: Time-dependent function returning an <code>SVector</code> of <span>$d$</span> dimensions                      for a <span>$d$</span>-dimensional problem.</li><li><code>is_moving</code>: Function to determine in each timestep if the particles are moving or not. Its   boolean return value is mandatory to determine if the neighborhood search will be updated.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>moving_particles</code>: Indices of moving particles. Default is each particle in <a href="#TrixiParticles.BoundarySPHSystem"><code>BoundarySPHSystem</code></a>.</li></ul><p>In the example below, <code>movement</code> describes particles moving in a circle as long as the time is lower than <code>1.5</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">movement_function(t) = SVector(cos(2pi*t), sin(2pi*t))
is_moving(t) = t &lt; 1.5

movement = BoundaryMovement(movement_function, is_moving)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/1575d76846627c667cfc322d1e15c10a96ead960/src/schemes/boundary/system.jl#L42-L67">source</a></section></article><h1 id="boundary_models"><a class="docs-heading-anchor" href="#boundary_models">Boundary Models</a><a id="boundary_models-1"></a><a class="docs-heading-anchor-permalink" href="#boundary_models" title="Permalink"></a></h1><h2 id="Dummy-Particles"><a class="docs-heading-anchor" href="#Dummy-Particles">Dummy Particles</a><a id="Dummy-Particles-1"></a><a class="docs-heading-anchor-permalink" href="#Dummy-Particles" title="Permalink"></a></h2><p>Boundaries modeled as dummy particles, which are treated like fluid particles, but their positions and velocities are not evolved in time. Since the force towards the fluid should not change with the material density when used with a <a href="../total_lagrangian_sph/#TrixiParticles.TotalLagrangianSPHSystem"><code>TotalLagrangianSPHSystem</code></a>, the dummy particles need to have a mass corresponding to the fluid&#39;s rest density, which we call &quot;hydrodynamic mass&quot;, as opposed to mass corresponding to the material density of a <a href="../total_lagrangian_sph/#TrixiParticles.TotalLagrangianSPHSystem"><code>TotalLagrangianSPHSystem</code></a>.</p><p>Here, <code>initial_density</code> and <code>hydrodynamic_mass</code> are vectors that contains the initial density and the hydrodynamic mass respectively for each boundary particle. Note that when used with <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a> (see below), this is only used to determine the element type and the number of boundary particles.</p><p>To establish a relationship between density and pressure, a <code>state_equation</code> has to be passed, which should be the same as for the adjacent fluid systems. To sum over neighboring particles, a <code>smoothing_kernel</code> and <code>smoothing_length</code> needs to be passed. This should be the same as for the adjacent fluid system with the largest smoothing length.</p><p>In the literature, this kind of boundary particles is referred to as &quot;dummy particles&quot; (Adami et al., 2012 and Valizadeh &amp; Monaghan, 2015), &quot;frozen fluid particles&quot; (Akinci et al., 2012) or &quot;dynamic boundaries (Crespo et al., 2007). The key detail of this boundary condition and the only difference between the boundary models in these references is the way the density and pressure of boundary particles is computed.</p><p>Since boundary particles are treated like fluid particles, the force on fluid particle <span>$a$</span> due to boundary particle <span>$b$</span> is given by</p><p class="math-container">\[f_{ab} = m_a m_b \left( \frac{p_a}{\rho_a^2} + \frac{p_b}{\rho_b^2} \right) \nabla_{r_a} W(\Vert r_a - r_b \Vert, h).\]</p><p>The quantities to be defined here are the density <span>$\rho_b$</span> and pressure <span>$p_b$</span> of the boundary particle <span>$b$</span>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.BoundaryModelDummyParticles" href="#TrixiParticles.BoundaryModelDummyParticles"><code>TrixiParticles.BoundaryModelDummyParticles</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BoundaryModelDummyParticles(initial_density, hydrodynamic_mass,
                            density_calculator, smoothing_kernel,
                            smoothing_length; viscosity=nothing,
                            state_equation=nothing, correction=nothing)</code></pre><p><code>boundary_model</code> for <code>BoundarySPHSystem</code>.</p><p><strong>Arguments</strong></p><ul><li><code>initial_density</code>: Vector holding the initial density of each boundary particle.</li><li><code>hydrodynamic_mass</code>: Vector holding the &quot;hydrodynamic mass&quot; of each boundary particle.                      See description above for more information.</li><li><code>density_calculator</code>: Strategy to compute the hydrodynamic density of the boundary particles.                       See description below for more information.</li><li><code>smoothing_kernel</code>: Smoothing kernel should be the same as for the adjacent fluid system.</li><li><code>smoothing_length</code>: Smoothing length should be the same as for the adjacent fluid system.</li></ul><p><strong>Keywords</strong></p><ul><li><code>state_equation</code>: This should be the same as for the adjacent fluid system                   (see e.g. <a href="../weakly_compressible_sph/#TrixiParticles.StateEquationCole"><code>StateEquationCole</code></a>).</li><li><code>correction</code>:     Correction method of the adjacent fluid system (see <a href="../weakly_compressible_sph/#corrections">Corrections</a>).</li><li><code>viscosity</code>:      Slip (default) or no-slip condition. See description below for further                   information.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Free-slip condition
boundary_model = BoundaryModelDummyParticles(densities, masses, AdamiPressureExtrapolation(),
                                             smoothing_kernel, smoothing_length)

# No-slip condition
boundary_model = BoundaryModelDummyParticles(densities, masses, AdamiPressureExtrapolation(),
                                             smoothing_kernel, smoothing_length,
                                             viscosity=ViscosityAdami(nu=1e-6))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/1575d76846627c667cfc322d1e15c10a96ead960/src/schemes/boundary/dummy_particles/dummy_particles.jl#L1-L39">source</a></section></article><h3 id="Hydrodynamic-density-of-dummy-particles"><a class="docs-heading-anchor" href="#Hydrodynamic-density-of-dummy-particles">Hydrodynamic density of dummy particles</a><a id="Hydrodynamic-density-of-dummy-particles-1"></a><a class="docs-heading-anchor-permalink" href="#Hydrodynamic-density-of-dummy-particles" title="Permalink"></a></h3><p>We provide five options to compute the boundary density and pressure, determined by the <code>density_calculator</code>:</p><ol><li>(Recommended) With <a href="#TrixiParticles.AdamiPressureExtrapolation"><code>AdamiPressureExtrapolation</code></a>, the pressure is extrapolated from the pressure of the fluid according to (Adami et al., 2012), and the density is obtained by applying the inverse of the state equation. This option usually yields the best results of the options listed here.</li><li>With <a href="../../general/density_calculators/#TrixiParticles.SummationDensity"><code>SummationDensity</code></a>, the density is calculated by summation over the neighboring particles, and the pressure is computed from the density with the state equation.</li><li>With <a href="../../general/density_calculators/#TrixiParticles.ContinuityDensity"><code>ContinuityDensity</code></a>, the density is integrated from the continuity equation, and the pressure is computed from the density with the state equation. Note that this causes a gap between fluid and boundary where the boundary is initialized without any contact to the fluid. This is due to overestimation of the boundary density as soon as the fluid comes in contact with boundary particles that initially did not have contact to the fluid. Therefore, in dam break simulations, there is a visible &quot;step&quot;, even though the boundary is supposed to be flat. See also <a href="https://dual.sphysics.org/faq/#Q_13">dual.sphysics.org/faq/#Q_13</a>.</li><li>With <a href="#TrixiParticles.PressureZeroing"><code>PressureZeroing</code></a>, the density is set to the reference density and the pressure is computed from the density with the state equation. This option is not recommended. The other options yield significantly better results.</li><li>With <a href="#TrixiParticles.PressureMirroring"><code>PressureMirroring</code></a>, the density is set to the reference density. The pressure is not used. Instead, the fluid pressure is mirrored as boundary pressure in the momentum equation. This option is not recommended due to stability issues. See <a href="#TrixiParticles.PressureMirroring"><code>PressureMirroring</code></a> for more details.</li></ol><h4 id="1.-[AdamiPressureExtrapolation](@ref)"><a class="docs-heading-anchor" href="#1.-[AdamiPressureExtrapolation](@ref)">1. <a href="#TrixiParticles.AdamiPressureExtrapolation"><code>AdamiPressureExtrapolation</code></a></a><a id="1.-[AdamiPressureExtrapolation](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#1.-[AdamiPressureExtrapolation](@ref)" title="Permalink"></a></h4><p>The pressure of the boundary particles is obtained by extrapolating the pressure of the fluid according to (Adami et al., 2012). The pressure of a boundary particle <span>$b$</span> is given by</p><p class="math-container">\[p_b = \frac{\sum_f (p_f + \rho_f (\bm{g} - \bm{a}_b) \cdot \bm{r}_{bf}) W(\Vert r_{bf} \Vert, h)}{\sum_f W(\Vert r_{bf} \Vert, h)},\]</p><p>where the sum is over all fluid particles, <span>$\rho_f$</span> and <span>$p_f$</span> denote the density and pressure of fluid particle <span>$f$</span>, respectively, <span>$r_{bf} = r_b - r_f$</span> denotes the difference of the coordinates of particles <span>$b$</span> and <span>$f$</span>, <span>$\bm{g}$</span> denotes the gravitational acceleration acting on the fluid, and <span>$\bm{a}_b$</span> denotes the acceleration of the boundary particle <span>$b$</span>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.AdamiPressureExtrapolation" href="#TrixiParticles.AdamiPressureExtrapolation"><code>TrixiParticles.AdamiPressureExtrapolation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AdamiPressureExtrapolation()</code></pre><p><code>density_calculator</code> for <code>BoundaryModelDummyParticles</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/1575d76846627c667cfc322d1e15c10a96ead960/src/schemes/boundary/dummy_particles/dummy_particles.jl#L76-L80">source</a></section></article><h4 id="4.-[PressureZeroing](@ref)"><a class="docs-heading-anchor" href="#4.-[PressureZeroing](@ref)">4. <a href="#TrixiParticles.PressureZeroing"><code>PressureZeroing</code></a></a><a id="4.-[PressureZeroing](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#4.-[PressureZeroing](@ref)" title="Permalink"></a></h4><p>This is the simplest way to implement dummy boundary particles. The density of each particle is set to the reference density and the pressure to the reference pressure (the corresponding pressure to the reference density by the state equation).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.PressureZeroing" href="#TrixiParticles.PressureZeroing"><code>TrixiParticles.PressureZeroing</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PressureZeroing()</code></pre><p><code>density_calculator</code> for <code>BoundaryModelDummyParticles</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This boundary model produces significantly worse results than all other models and is only included for research purposes.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/1575d76846627c667cfc322d1e15c10a96ead960/src/schemes/boundary/dummy_particles/dummy_particles.jl#L98-L106">source</a></section></article><h4 id="5.-[PressureMirroring](@ref)"><a class="docs-heading-anchor" href="#5.-[PressureMirroring](@ref)">5. <a href="#TrixiParticles.PressureMirroring"><code>PressureMirroring</code></a></a><a id="5.-[PressureMirroring](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#5.-[PressureMirroring](@ref)" title="Permalink"></a></h4><p>Instead of calculating density and pressure for each boundary particle, we modify the momentum equation,</p><p class="math-container">\[\frac{\mathrm{d}v_a}{\mathrm{d}t} = -\sum_b m_b \left( \frac{p_a}{\rho_a^2} + \frac{p_b}{\rho_b^2} \right) \nabla_a W_{ab}\]</p><p>to replace the unknown density <span>$\rho_b$</span> if <span>$b$</span> is a boundary particle by the reference density and the unknown pressure <span>$p_b$</span> if <span>$b$</span> is a boundary particle by the pressure <span>$p_a$</span> of the interacting fluid particle. The momentum equation therefore becomes</p><p class="math-container">\[\frac{\mathrm{d}v_a}{\mathrm{d}t} = -\sum_f m_f \left( \frac{p_a}{\rho_a^2} + \frac{p_f}{\rho_f^2} \right) \nabla_a W_{af}
-\sum_b m_b \left( \frac{p_a}{\rho_a^2} + \frac{p_a}{\rho_0^2} \right) \nabla_a W_{ab},\]</p><p>where the first sum is over all fluid particles and the second over all boundary particles.</p><p>This approach was first mentioned by Akinci et al. (2012) and written down in this form by Band et al. (2018).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.PressureMirroring" href="#TrixiParticles.PressureMirroring"><code>TrixiParticles.PressureMirroring</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PressureMirroring()</code></pre><p><code>density_calculator</code> for <code>BoundaryModelDummyParticles</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This boundary model requires high viscosity for stability with WCSPH. It also produces significantly worse results than <a href="#TrixiParticles.AdamiPressureExtrapolation"><code>AdamiPressureExtrapolation</code></a> and is not more efficient because smaller time steps are required due to more noise in the pressure. We added this model only for research purposes and for comparison with <a href="https://github.com/InteractiveComputerGraphics/SPlisHSPlasH">SPlisHSPlasH</a>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/1575d76846627c667cfc322d1e15c10a96ead960/src/schemes/boundary/dummy_particles/dummy_particles.jl#L83-L95">source</a></section></article><h3 id="No-slip-conditions"><a class="docs-heading-anchor" href="#No-slip-conditions">No-slip conditions</a><a id="No-slip-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#No-slip-conditions" title="Permalink"></a></h3><p>For the interaction of dummy particles and fluid particles, Adami et al. (2012) impose a no-slip boundary condition by assigning a wall velocity <span>$v_w$</span> to the dummy particle.</p><p>The wall velocity of particle <span>$a$</span> is calculated from the prescribed boundary particle velocity <span>$v_a$</span> and the smoothed velocity field</p><p class="math-container">\[v_w = 2 v_a - \frac{\sum_b v_b W_{ab}}{\sum_b W_{ab}},\]</p><p>where the sum is over all fluid particles.</p><p>By choosing the viscosity model <a href="../weakly_compressible_sph/#TrixiParticles.ViscosityAdami"><code>ViscosityAdami</code></a> for <code>viscosity</code>, a no-slip condition is imposed. It is recommended to choose <code>nu</code> in the order of either the kinematic viscosity parameter of the adjacent fluid or the equivalent from the artificial parameter <code>alpha</code> of the adjacent fluid (<span>$\nu = \frac{\alpha h c }{2d + 4}$</span>). When omitting the viscous interaction (default <code>viscosity=nothing</code>), a free-slip wall boundary condition is applied.</p><h3 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h3><ul><li>S. Adami, X. Y. Hu, N. A. Adams. &quot;A generalized wall boundary condition for smoothed particle hydrodynamics&quot;. In: Journal of Computational Physics 231, 21 (2012), pages 7057–7075. <a href="https://doi.org/10.1016/J.JCP.2012.05.005">doi: 10.1016/J.JCP.2012.05.005</a></li><li>Alireza Valizadeh, Joseph J. Monaghan. &quot;A study of solid wall models for weakly compressible SPH&quot;. In: Journal of Computational Physics 300 (2015), pages 5–19. <a href="https://doi.org/10.1016/J.JCP.2015.07.033">doi: 10.1016/J.JCP.2015.07.033</a></li><li>Nadir Akinci, Markus Ihmsen, Gizem Akinci, Barbara Solenthaler, Matthias Teschner. &quot;Versatile rigid-fluid coupling for incompressible SPH&quot;. ACM Transactions on Graphics 31, 4 (2012), pages 1–8. <a href="https://doi.org/10.1145/2185520.2185558">doi: 10.1145/2185520.2185558</a></li><li>A. J. C. Crespo, M. Gómez-Gesteira, R. A. Dalrymple. &quot;Boundary conditions generated by dynamic particles in SPH methods&quot; In: Computers, Materials and Continua 5 (2007), pages 173-184. <a href="https://doi.org/10.3970/cmc.2007.005.173">doi: 10.3970/cmc.2007.005.173</a></li><li>Stefan Band, Christoph Gissler, Andreas Peer, and Matthias Teschner. &quot;MLS Pressure Boundaries for Divergence-Free and Viscous SPH Fluids.&quot; In: Computers &amp; Graphics 76 (2018), pages 37–46. <a href="https://doi.org/10.1016/j.cag.2018.08.001">doi: 10.1016/j.cag.2018.08.001</a></li></ul><h2 id="Repulsive-Particles"><a class="docs-heading-anchor" href="#Repulsive-Particles">Repulsive Particles</a><a id="Repulsive-Particles-1"></a><a class="docs-heading-anchor-permalink" href="#Repulsive-Particles" title="Permalink"></a></h2><p>Boundaries modeled as boundary particles which exert forces on the fluid particles (Monaghan, Kajtar, 2009). The force on fluid particle <span>$a$</span> due to boundary particle <span>$b$</span> is given by</p><p class="math-container">\[f_{ab} = m_a \left(\tilde{f}_{ab} - m_b \Pi_{ab} \nabla_{r_a} W(\Vert r_a - r_b \Vert, h)\right)\]</p><p>with</p><p class="math-container">\[\tilde{f}_{ab} = \frac{K}{\beta^{n-1}} \frac{r_{ab}}{\Vert r_{ab} \Vert (\Vert r_{ab} \Vert - d)} \Phi(\Vert r_{ab} \Vert, h)
\frac{2 m_b}{m_a + m_b},\]</p><p>where <span>$m_a$</span> and <span>$m_b$</span> are the masses of fluid particle <span>$a$</span> and boundary particle <span>$b$</span> respectively, <span>$r_{ab} = r_a - r_b$</span> is the difference of the coordinates of particles <span>$a$</span> and <span>$b$</span>, <span>$d$</span> denotes the boundary particle spacing and <span>$n$</span> denotes the number of dimensions (see (Monaghan, Kajtar, 2009, Equation (3.1)) and (Valizadeh, Monaghan, 2015)). Note that the repulsive acceleration <span>$\tilde{f}_{ab}$</span> does not depend on the masses of the boundary particles. Here, <span>$\Phi$</span> denotes the 1D Wendland C4 kernel, normalized to <span>$1.77$</span> for <span>$q=0$</span> (Monaghan, Kajtar, 2009, Section 4), with <span>$\Phi(r, h) = w(r/h)$</span> and</p><p class="math-container">\[w(q) =
\begin{cases}
  (1.77/32) (1 + (5/2)q + 2q^2)(2 - q)^5  &amp; \text{if } 0 \leq q &lt; 2 \\
  0                                       &amp; \text{if } q \geq 2.
\end{cases}\]</p><p>The boundary particles are assumed to have uniform spacing by the factor <span>$\beta$</span> smaller than the expected fluid particle spacing. For example, if the fluid particles have an expected spacing of <span>$0.3$</span> and the boundary particles have a uniform spacing of <span>$0.1$</span>, then this parameter should be set to <span>$\beta = 3$</span>. According to (Monaghan, Kajtar, 2009), a value of <span>$\beta = 3$</span> for the Wendland C4 that we use here is reasonable for most computing purposes.</p><p>The parameter <span>$K$</span> is used to scale the force exerted by the boundary particles. In (Monaghan, Kajtar, 2009), a value of <span>$gD$</span> is used for static tank simulations, where <span>$g$</span> is the gravitational acceleration and <span>$D$</span> is the depth of the fluid.</p><p>The viscosity <span>$\Pi_{ab}$</span> is calculated according to the viscosity used in the simulation, where the density of the boundary particle if needed is assumed to be identical to the density of the fluid particle.</p><h3 id="No-slip-condition"><a class="docs-heading-anchor" href="#No-slip-condition">No-slip condition</a><a id="No-slip-condition-1"></a><a class="docs-heading-anchor-permalink" href="#No-slip-condition" title="Permalink"></a></h3><p>By choosing the viscosity model <a href="../weakly_compressible_sph/#TrixiParticles.ArtificialViscosityMonaghan"><code>ArtificialViscosityMonaghan</code></a> for <code>viscosity</code>, a no-slip condition is imposed. When omitting the viscous interaction (default <code>viscosity=nothing</code>), a free-slip wall boundary condition is applied.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The no-slip conditions for <code>BoundaryModelMonaghanKajtar</code> have not been verified yet.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.BoundaryModelMonaghanKajtar" href="#TrixiParticles.BoundaryModelMonaghanKajtar"><code>TrixiParticles.BoundaryModelMonaghanKajtar</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BoundaryModelMonaghanKajtar(K, beta, boundary_particle_spacing, mass;
                            viscosity=nothing)</code></pre><p><code>boundary_model</code> for <code>BoundarySPHSystem</code>.</p><p><strong>Arguments</strong></p><ul><li><code>K</code>: Scaling factor for repulsive force.</li><li><code>beta</code>: Ratio of fluid particle spacing to boundary particle spacing.</li><li><code>boundary_particle_spacing</code>: Boundary particle spacing.</li><li><code>mass</code>: Vector holding the mass of each boundary particle.</li></ul><p><strong>Keywords</strong></p><ul><li><code>viscosity</code>:  Free-slip (default) or no-slip condition. See description above for further               information.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/1575d76846627c667cfc322d1e15c10a96ead960/src/schemes/boundary/monaghan_kajtar/monaghan_kajtar.jl#L1-L16">source</a></section></article><h3 id="References-2"><a class="docs-heading-anchor" href="#References-2">References</a><a class="docs-heading-anchor-permalink" href="#References-2" title="Permalink"></a></h3><ul><li>Joseph J. Monaghan, Jules B. Kajtar. &quot;SPH particle boundary forces for arbitrary boundaries&quot;. In: Computer Physics Communications 180.10 (2009), pages 1811–1820. <a href="https://doi.org/10.1016/j.cpc.2009.05.008">doi: 10.1016/j.cpc.2009.05.008</a></li><li>Alireza Valizadeh, Joseph J. Monaghan. &quot;A study of solid wall models for weakly compressible SPH.&quot; In: Journal of Computational Physics 300 (2015), pages 5–19. <a href="https://doi.org/10.1016/J.JCP.2015.07.033">doi: 10.1016/J.JCP.2015.07.033</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../total_lagrangian_sph/">« Total Lagrangian SPH (Elastic Structure)</a><a class="docs-footer-nextpage" href="../../time_integration/">Time Integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Tuesday 19 March 2024 09:23">Tuesday 19 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
