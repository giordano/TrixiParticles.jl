<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Neighborhood Search · TrixiParticles.jl</title><meta name="title" content="Neighborhood Search · TrixiParticles.jl"/><meta property="og:title" content="Neighborhood Search · TrixiParticles.jl"/><meta property="twitter:title" content="Neighborhood Search · TrixiParticles.jl"/><meta name="description" content="Documentation for TrixiParticles.jl."/><meta property="og:description" content="Documentation for TrixiParticles.jl."/><meta property="twitter:description" content="Documentation for TrixiParticles.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TrixiParticles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../news/">News</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../getting_started/">Getting started</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><span class="tocitem">Components</span><ul><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox" checked/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">General</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../semidiscretization/">Semidiscretization</a></li><li><a class="tocitem" href="../initial_condition/">Initial Condition and Setups</a></li><li><a class="tocitem" href="../interpolation/">Interpolation</a></li><li><a class="tocitem" href="../density_calculators/">Density Calculators</a></li><li><a class="tocitem" href="../smoothing_kernels/">Smoothing Kernels</a></li><li class="is-active"><a class="tocitem" href>Neighborhood Search</a></li><li><a class="tocitem" href="../util/">Util</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox"/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../systems/weakly_compressible_sph/">Weakly Compressible SPH (Fluid)</a></li><li><a class="tocitem" href="../../systems/entropically_damped_sph/">Entropically Damped Artificial Compressibility for SPH (Fluid)</a></li><li><a class="tocitem" href="../../systems/total_lagrangian_sph/">Total Lagrangian SPH (Elastic Structure)</a></li><li><a class="tocitem" href="../../systems/boundary/">Boundary</a></li></ul></li><li><a class="tocitem" href="../../time_integration/">Time Integration</a></li><li><a class="tocitem" href="../../callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../reference-trixibase/">TrixiBase.jl API Reference</a></li></ul></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Components</a></li><li><a class="is-disabled">General</a></li><li class="is-active"><a href>Neighborhood Search</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Neighborhood Search</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/main/docs/src/general/neighborhood_search.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Neighborhood-Search"><a class="docs-heading-anchor" href="#Neighborhood-Search">Neighborhood Search</a><a id="Neighborhood-Search-1"></a><a class="docs-heading-anchor-permalink" href="#Neighborhood-Search" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.GridNeighborhoodSearch" href="#TrixiParticles.GridNeighborhoodSearch"><code>TrixiParticles.GridNeighborhoodSearch</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GridNeighborhoodSearch{NDIMS}(search_radius, n_particles; periodic_box_min_corner=nothing,
                              periodic_box_max_corner=nothing, threaded_nhs_update=true)</code></pre><p>Simple grid-based neighborhood search with uniform search radius. The domain is divided into a regular grid. For each (non-empty) grid cell, a list of particles in this cell is stored. Instead of representing a finite domain by an array of cells, a potentially infinite domain is represented by storing cell lists in a hash table (using Julia&#39;s <code>Dict</code> data structure), indexed by the cell index tuple</p><p class="math-container">\[\left( \left\lfloor \frac{x}{d} \right\rfloor, \left\lfloor \frac{y}{d} \right\rfloor \right) \quad \text{or} \quad
\left( \left\lfloor \frac{x}{d} \right\rfloor, \left\lfloor \frac{y}{d} \right\rfloor, \left\lfloor \frac{z}{d} \right\rfloor \right),\]</p><p>where <span>$x, y, z$</span> are the space coordinates and <span>$d$</span> is the search radius.</p><p>To find particles within the search radius around a point, only particles in the neighboring cells are considered.</p><p>See also (Chalela et al., 2021), (Ihmsen et al. 2011, Section 4.4).</p><p>As opposed to (Ihmsen et al. 2011), we do not sort the particles in any way, since not sorting makes our implementation a lot faster (although less parallelizable).</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>:          Number of dimensions.</li><li><code>search_radius</code>:  The uniform search radius.</li><li><code>n_particles</code>:    Total number of particles.</li></ul><p><strong>Keywords</strong></p><ul><li><code>periodic_box_min_corner</code>:    In order to use a (rectangular) periodic domain, pass the                               coordinates of the domain corner in negative coordinate                               directions.</li><li><code>periodic_box_max_corner</code>:    In order to use a (rectangular) periodic domain, pass the                               coordinates of the domain corner in positive coordinate                               directions.</li><li><code>threaded_nhs_update=true</code>:              Can be used to deactivate thread parallelization in the neighborhood search update.                               This can be one of the largest sources of variations between simulations                               with different thread numbers due to particle ordering changes.</li></ul><div class="admonition is-warning"><header class="admonition-header">Internal use only</header><div class="admonition-body"><p>Please note that this constructor is intended for internal use only. It is <em>not</em> part of the public API of TrixiParticles.jl, and it thus can altered (or be removed) at any time without it being considered a breaking change.</p><p>To run a simulation with this neighborhood search, just pass the type to the constructor of <a href="../semidiscretization/#Semidiscretization"><code>Semidiscretization</code></a>:</p><pre><code class="language-julia hljs">semi = Semidiscretization(system1, system2,
                          neighborhood_search=GridNeighborhoodSearch)</code></pre><p>The keyword arguments <code>periodic_box_min_corner</code> and <code>periodic_box_max_corner</code> explained above can also be passed to the <a href="../semidiscretization/#Semidiscretization"><code>Semidiscretization</code></a> and will internally be forwarded to the neighborhood search:</p><pre><code class="language-julia hljs">semi = Semidiscretization(system1, system2,
                          neighborhood_search=GridNeighborhoodSearch,
                          periodic_box_min_corner=[0.0, -0.25],
                          periodic_box_max_corner=[1.0, 0.75])</code></pre></div></div><p><strong>References</strong></p><ul><li>M. Chalela, E. Sillero, L. Pereyra, M.A. Garcia, J.B. Cabral, M. Lares, M. Merchán. &quot;GriSPy: A Python package for fixed-radius nearest neighbors search&quot;. In: Astronomy and Computing 34 (2021). <a href="https://doi.org/10.1016/j.ascom.2020.100443">doi: 10.1016/j.ascom.2020.100443</a></li><li>Markus Ihmsen, Nadir Akinci, Markus Becker, Matthias Teschner. &quot;A Parallel SPH Implementation on Multi-Core CPUs&quot;. In: Computer Graphics Forum 30.1 (2011), pages 99–112. <a href="https://doi.org/10.1111/J.1467-8659.2010.01832.X">doi: 10.1111/J.1467-8659.2010.01832.X</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/0ffdcec31b27f69a7457ffa98d0c7880e24813d3/src/neighborhood_search/grid_nhs.jl#L1-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TrixiParticles.TrivialNeighborhoodSearch" href="#TrixiParticles.TrivialNeighborhoodSearch"><code>TrixiParticles.TrivialNeighborhoodSearch</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TrivialNeighborhoodSearch{NDIMS}(search_radius, eachparticle)</code></pre><p>Trivial neighborhood search that simply loops over all particles. The search radius still needs to be passed in order to sort out particles outside the search radius in the internal function <code>for_particle_neighbor</code>, but it&#39;s not used in the internal function <code>eachneighbor</code>.</p><p><strong>Arguments</strong></p><ul><li><code>NDIMS</code>:          Number of dimensions.</li><li><code>search_radius</code>:  The uniform search radius.</li><li><code>eachparticle</code>:   <code>UnitRange</code> of all particle indices. Usually just <code>1:n_particles</code>.</li></ul><p><strong>Keywords</strong></p><ul><li><code>periodic_box_min_corner</code>:    In order to use a (rectangular) periodic domain, pass the                               coordinates of the domain corner in negative coordinate                               directions.</li><li><code>periodic_box_max_corner</code>:    In order to use a (rectangular) periodic domain, pass the                               coordinates of the domain corner in positive coordinate                               directions.</li></ul><div class="admonition is-warning"><header class="admonition-header">Internal use only</header><div class="admonition-body"><p>Please note that this constructor is intended for internal use only. It is <em>not</em> part of the public API of TrixiParticles.jl, and it thus can altered (or be removed) at any time without it being considered a breaking change.</p><p>To run a simulation with this neighborhood search, just pass the type to the constructor of <a href="../semidiscretization/#Semidiscretization"><code>Semidiscretization</code></a>:</p><pre><code class="language-julia hljs">semi = Semidiscretization(system1, system2,
                          neighborhood_search=TrivialNeighborhoodSearch)</code></pre><p>The keyword arguments <code>periodic_box_min_corner</code> and <code>periodic_box_max_corner</code> explained above can also be passed to the <a href="../semidiscretization/#Semidiscretization"><code>Semidiscretization</code></a> and will internally be forwarded to the neighborhood search:</p><pre><code class="language-julia hljs">semi = Semidiscretization(system1, system2,
                          neighborhood_search=TrivialNeighborhoodSearch,
                          periodic_box_min_corner=[0.0, -0.25],
                          periodic_box_max_corner=[1.0, 0.75])</code></pre></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiParticles.jl/blob/0ffdcec31b27f69a7457ffa98d0c7880e24813d3/src/neighborhood_search/trivial_nhs.jl#L1-L62">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../smoothing_kernels/">« Smoothing Kernels</a><a class="docs-footer-nextpage" href="../util/">Util »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Monday 18 March 2024 13:21">Monday 18 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
